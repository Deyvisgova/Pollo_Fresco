<section class="seccion__tarjeta">
  <header class="seccion__encabezado">
    <div>
      <h3>Productos</h3>
      <p>Administra los productos disponibles para otros productos.</p>
    </div>
    <button class="boton boton--primario" (click)="abrirModalNuevo()">
      Nuevo producto
    </button>
  </header>

  <div class="seccion__acciones">
    <input
      type="search"
      placeholder="Buscar por nombre o estado..."
      [(ngModel)]="filtro"
    />
    <button class="boton boton--secundario">Buscar</button>
  </div>

  <p class="seccion__error" *ngIf="mensajeError">{{ mensajeError }}</p>

  <div class="seccion__tabla">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Nombre</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let producto of productosFiltrados">
          <td>{{ producto.id }}</td>
          <td>{{ producto.nombre }}</td>
          <td>
            <span
              class="etiqueta"
              [class.etiqueta--cerrada]="!producto.activo"
            >
              {{ obtenerEstadoTexto(producto) }}
            </span>
          </td>
          <td class="tabla__acciones">
            <button
              class="boton boton--accion"
              (click)="seleccionarProducto(producto)"
              title="Editar"
            >
              ‚úèÔ∏è
            </button>
            <button
              class="boton boton--accion boton--peligro"
              [disabled]="!producto.activo"
              (click)="eliminarProducto(producto)"
              title="Eliminar"
            >
              üóëÔ∏è
            </button>
          </td>
        </tr>
        <tr *ngIf="productosFiltrados.length === 0">
          <td colspan="4">No hay productos con ese filtro.</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<div class="modal" *ngIf="mostrarModal">
  <div class="modal__contenido">
    <header class="modal__encabezado">
      <div>
        <h3>{{ modoEdicion ? 'Editar producto' : 'Nuevo producto' }}</h3>
        <p>Registra o actualiza el nombre del producto.</p>
      </div>
      <button class="boton boton--texto" (click)="cerrarModal()">Cerrar</button>
    </header>

    <div class="modal__grid">
      <label>
        Nombre del producto
        <input
          type="text"
          [(ngModel)]="formulario.nombre"
          placeholder="Ej: Huevos de codorniz"
        />
      </label>
      <label class="modal__switch">
        <span>Estado</span>
        <select [(ngModel)]="formulario.activo">
          <option [ngValue]="true">Activo</option>
          <option [ngValue]="false">Inactivo</option>
        </select>
      </label>
    </div>

    <p class="modal__error" *ngIf="mensajeError">{{ mensajeError }}</p>

    <div class="modal__acciones">
      <button class="boton boton--primario" (click)="guardarProducto()">
        {{ modoEdicion ? 'Actualizar producto' : 'Guardar producto' }}
      </button>
    </div>
  </div>
</div>
